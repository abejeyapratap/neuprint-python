

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Common Queries &mdash; neuprint-python 0.3.4 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="SegmentCriteria" href="segmentcriteria.html" />
    <link rel="prev" title="Client" href="client.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> neuprint-python
          

          
          </a>

          
            
            
              <div class="version">
                0.3.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="api.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="client.html">Client</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Common Queries</a></li>
<li class="toctree-l2"><a class="reference internal" href="segmentcriteria.html">SegmentCriteria</a></li>
<li class="toctree-l2"><a class="reference internal" href="admin.html">Admin Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="deprecated.html">Deprecated API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Development Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">neuprint-python</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="api.html">API</a> &raquo;</li>
        
      <li>Common Queries</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/queries.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="common-queries">
<span id="queries"></span><h1>Common Queries<a class="headerlink" href="#common-queries" title="Permalink to this headline">¶</a></h1>
<p>Convenience functions for common queries.</p>
<p>If you are familiar with the neuPrint data model and the
<a class="reference external" href="https://neo4j.com/developer/cypher-query-language/">cypher</a>
query language, you can write your own queries using
<a class="reference internal" href="#neuprint.queries.fetch_custom" title="neuprint.queries.fetch_custom"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_custom</span></code></a>.
But the functions in this file offer a convenient API for common queries.</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#neuprint.queries.fetch_custom" title="neuprint.queries.fetch_custom"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_custom</span></code></a>(cypher[,&nbsp;dataset,&nbsp;format,&nbsp;client])</td>
<td>Alternative form of <a class="reference internal" href="client.html#neuprint.client.Client.fetch_custom" title="neuprint.client.Client.fetch_custom"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Client.fetch_custom()</span></code></a>, as a free function.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#neuprint.queries.fetch_neurons" title="neuprint.queries.fetch_neurons"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_neurons</span></code></a>(criteria,&nbsp;*[,&nbsp;client])</td>
<td>Search for a set of Neurons (or Segments) that match the given <a class="reference internal" href="segmentcriteria.html#neuprint.SegmentCriteria" title="neuprint.SegmentCriteria"><code class="xref py py-class docutils literal notranslate"><span class="pre">SegmentCriteria</span></code></a>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#neuprint.queries.fetch_custom_neurons" title="neuprint.queries.fetch_custom_neurons"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_custom_neurons</span></code></a>(q,&nbsp;*[,&nbsp;client])</td>
<td>Use a custom query to fetch a neuron table, with nicer output than you would get from a call to <a class="reference internal" href="#neuprint.queries.fetch_custom" title="neuprint.queries.fetch_custom"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_custom()</span></code></a>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#neuprint.queries.fetch_simple_connections" title="neuprint.queries.fetch_simple_connections"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_simple_connections</span></code></a>([…])</td>
<td>Find all connections from a set of “upstream” neurons, or to a set of “downstream” neurons, or all connections from a set of upstream neurons to a set of downstream neurons.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#neuprint.queries.fetch_common_connectivity" title="neuprint.queries.fetch_common_connectivity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_common_connectivity</span></code></a>(criteria[,&nbsp;…])</td>
<td>Given a set of neurons that match the given criteria, find neurons that connect to ALL of the neurons in the set, i.e.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#neuprint.queries.fetch_shortest_paths" title="neuprint.queries.fetch_shortest_paths"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_shortest_paths</span></code></a>(upstream_bodyId,&nbsp;…[,&nbsp;…])</td>
<td>Find all neurons along the shortest path between two neurons.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#neuprint.queries.fetch_adjacencies" title="neuprint.queries.fetch_adjacencies"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_adjacencies</span></code></a>(criteria[,&nbsp;export_dir,&nbsp;…])</td>
<td>Fetch the adjacency table for connections amongst a set of neurons, broken down by ROI.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#neuprint.queries.fetch_traced_adjacencies" title="neuprint.queries.fetch_traced_adjacencies"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_traced_adjacencies</span></code></a>([export_dir,&nbsp;…])</td>
<td>Convenience function for calling <a class="reference internal" href="#neuprint.queries.fetch_adjacencies" title="neuprint.queries.fetch_adjacencies"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_adjacencies()</span></code></a> for traced, non-cropped neurons.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#neuprint.queries.fetch_meta" title="neuprint.queries.fetch_meta"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_meta</span></code></a>(*[,&nbsp;client])</td>
<td>Fetch the dataset metadata, parsing json fields where necessary.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#neuprint.queries.fetch_all_rois" title="neuprint.queries.fetch_all_rois"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_all_rois</span></code></a>(*[,&nbsp;client])</td>
<td>Fetch the list of all ROIs in the dataset, from the dataset metadata.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#neuprint.queries.fetch_primary_rois" title="neuprint.queries.fetch_primary_rois"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_primary_rois</span></code></a>(*[,&nbsp;client])</td>
<td>Fetch the list of ‘primary’ ROIs in the dataset, from the dataset metadata.</td>
</tr>
</tbody>
</table>
<span class="target" id="module-neuprint.queries"></span><dl class="function">
<dt id="neuprint.queries.fetch_custom">
<code class="descclassname">neuprint.queries.</code><code class="descname">fetch_custom</code><span class="sig-paren">(</span><em>cypher</em>, <em>dataset=''</em>, <em>format='pandas'</em>, <em>*</em>, <em>client=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuprint/queries.html#fetch_custom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neuprint.queries.fetch_custom" title="Permalink to this definition">¶</a></dt>
<dd><p>Alternative form of <a class="reference internal" href="client.html#neuprint.client.Client.fetch_custom" title="neuprint.client.Client.fetch_custom"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Client.fetch_custom()</span></code></a>, as a free function.
That is, <code class="docutils literal notranslate"><span class="pre">fetch_custom(...,</span> <span class="pre">client=c)</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">c.fetch_custom(...)</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">client=None</span></code>, the default <code class="docutils literal notranslate"><span class="pre">Client</span></code> is used
(assuming you have created at least one <code class="docutils literal notranslate"><span class="pre">Client</span></code>.)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cypher</strong> – A cypher query string</li>
<li><strong>dataset</strong> – <p><em>Deprecated. Please provide your dataset as a Client constructor argument.</em></p>
<p>Which neuprint dataset to query against.
If None provided, the client’s default dataset is used.</p>
</li>
<li><strong>format</strong> – Either ‘pandas’ or ‘json’.
Whether to load the results into a pandas DataFrame,
or return the server’s raw json response as a Python dict.</li>
<li><strong>client</strong> – If not provided, the global default <a class="reference internal" href="client.html#neuprint.client.Client" title="neuprint.client.Client"><code class="xref py py-class docutils literal notranslate"><span class="pre">Client</span></code></a> will be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Either json or DataFrame, depending on <code class="docutils literal notranslate"><span class="pre">format</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neuprint.queries.fetch_neurons">
<code class="descclassname">neuprint.queries.</code><code class="descname">fetch_neurons</code><span class="sig-paren">(</span><em>criteria</em>, <em>*</em>, <em>client=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuprint/queries.html#fetch_neurons"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neuprint.queries.fetch_neurons" title="Permalink to this definition">¶</a></dt>
<dd><p>Search for a set of Neurons (or Segments) that match the given <a class="reference internal" href="segmentcriteria.html#neuprint.SegmentCriteria" title="neuprint.SegmentCriteria"><code class="xref py py-class docutils literal notranslate"><span class="pre">SegmentCriteria</span></code></a>.
Returns their properties, including the distibution of their synapses in all brain regions.</p>
<p>This implements a superset of the features on the Neuprint Explorer <a class="reference external" href="https://neuprint.janelia.org/?dataset=hemibrain%3Av1.0&amp;qt=findneurons&amp;q=1">Find Neurons</a> page.</p>
<p>Returns data in the the same format as <a class="reference internal" href="#neuprint.queries.fetch_custom_neurons" title="neuprint.queries.fetch_custom_neurons"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_custom_neurons()</span></code></a>,
but doesn’t require you to write cypher.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>criteria</strong> (<a class="reference internal" href="segmentcriteria.html#neuprint.SegmentCriteria" title="neuprint.SegmentCriteria"><code class="xref py py-class docutils literal notranslate"><span class="pre">SegmentCriteria</span></code></a>) – Only Neurons which satisfy all components of the given criteria are returned.</li>
<li><strong>client</strong> – If not provided, the global default <a class="reference internal" href="client.html#neuprint.client.Client" title="neuprint.client.Client"><code class="xref py py-class docutils literal notranslate"><span class="pre">Client</span></code></a> will be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>Two DataFrames.
<code class="docutils literal notranslate"><span class="pre">(neurons_df,</span> <span class="pre">roi_counts_df)</span></code></p>
<p>In <code class="docutils literal notranslate"><span class="pre">neurons_df</span></code>, all available <code class="docutils literal notranslate"><span class="pre">:Neuron</span></code> columns are returned, with the following changes:</p>
<blockquote>
<div><ul class="simple">
<li>ROI boolean columns are removed</li>
<li><code class="docutils literal notranslate"><span class="pre">roiInfo</span></code> is parsed as json data</li>
<li><code class="docutils literal notranslate"><span class="pre">somaLocation</span></code> is provided as a list <code class="docutils literal notranslate"><span class="pre">[x,</span> <span class="pre">y,</span> <span class="pre">z]</span></code></li>
<li>New columns <code class="docutils literal notranslate"><span class="pre">input_rois</span></code> and <code class="docutils literal notranslate"><span class="pre">output_rois</span></code> contain lists of each neuron’s ROIs.</li>
</ul>
</div></blockquote>
<p>In <code class="docutils literal notranslate"><span class="pre">roi_counts_df</span></code>, the <code class="docutils literal notranslate"><span class="pre">roiInfo</span></code> has been loadded into a table
of per-neuron-per-ROI synapse counts, with separate columns
for <code class="docutils literal notranslate"><span class="pre">pre</span></code> (outputs) and <code class="docutils literal notranslate"><span class="pre">post</span></code> (inputs).</p>
</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">If you like the output format of this function but you want
to provide your own cypher query, see <a class="reference internal" href="#neuprint.queries.fetch_custom_neurons" title="neuprint.queries.fetch_custom_neurons"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_custom_neurons()</span></code></a>.</p>
</div>
<p class="rubric">Example</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">neuprint</span> <span class="kn">import</span> <span class="n">fetch_neurons</span><span class="p">,</span> <span class="n">SegmentCriteria</span> <span class="k">as</span> <span class="n">SC</span>

<span class="gp">In [2]: </span><span class="n">neurons_df</span><span class="p">,</span> <span class="n">roi_counts_df</span> <span class="o">=</span> <span class="n">fetch_neurons</span><span class="p">(</span>
<span class="gp">   ...: </span>    <span class="n">SC</span><span class="p">(</span><span class="n">inputRois</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;SIP(R)&#39;</span><span class="p">,</span> <span class="s1">&#39;aL(R)&#39;</span><span class="p">],</span>
<span class="gp">   ...: </span>       <span class="n">status</span><span class="o">=</span><span class="s1">&#39;Traced&#39;</span><span class="p">,</span>
<span class="gp">   ...: </span>       <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;MBON.*&#39;</span><span class="p">,</span>
<span class="gp">   ...: </span>       <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

<span class="gp">In [3]: </span><span class="n">neurons_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">11</span><span class="p">]</span>
<span class="gh">Out[3]:</span>
<span class="go">      bodyId                     instance    type cellBodyFiber   pre   post        size  status  cropped     statusLabel  somaRadius</span>
<span class="go">0  300972942                 MBON14(a3)_R  MBON14           NaN   543  13634  1563154937  Traced    False  Roughly traced         NaN</span>
<span class="go">1  422725634        MBON06(B1&gt;a)(AVM07)_L  MBON06           NaN  1356  20978  3118269136  Traced    False  Roughly traced         NaN</span>
<span class="go">2  423382015        MBON23(a2sp)(PDL05)_R  MBON23          SFS1   733   4466   857093893  Traced    False  Roughly traced       291.0</span>
<span class="go">3  423774471       MBON19(a2p3p)(PDL05)_R  MBON19          SFS1   299   1484   628019179  Traced    False  Roughly traced       286.0</span>
<span class="go">4  424767514  MBON11(y1pedc&gt;a/B)(ADM05)_R  MBON11        mAOTU2  1643  27641  5249327644  Traced    False          Traced       694.5</span>

<span class="gp">In [4]: </span><span class="n">neurons_df</span><span class="p">[</span><span class="s1">&#39;inputRois&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="gh">Out[4]:</span>
<span class="go">0    [MB(+ACA)(R), MB(R), None, SIP(R), SLP(R), SMP...</span>
<span class="go">1    [CRE(-ROB,-RUB)(R), CRE(R), INP, MB(+ACA)(R), ...</span>
<span class="go">2    [MB(+ACA)(R), MB(R), None, SIP(R), SLP(R), SMP...</span>
<span class="go">3    [MB(+ACA)(R), MB(R), SIP(R), SMP(R), SNP(R), a...</span>
<span class="go">4    [CRE(-ROB,-RUB)(R), CRE(L), CRE(R), INP, MB(+A...</span>
<span class="go">Name: inputRois, dtype: object</span>

<span class="gp">In [5]: </span><span class="n">roi_counts_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="gh">Out[5]:</span>
<span class="go">      bodyId          roi  pre   post</span>
<span class="go">0  300972942        MB(R)   17  13295</span>
<span class="go">1  300972942        aL(R)   17  13271</span>
<span class="go">2  300972942        a3(R)   17  13224</span>
<span class="go">3  300972942  MB(+ACA)(R)   17  13295</span>
<span class="go">4  300972942       SNP(R)  526    336</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="neuprint.queries.fetch_custom_neurons">
<code class="descclassname">neuprint.queries.</code><code class="descname">fetch_custom_neurons</code><span class="sig-paren">(</span><em>q</em>, <em>*</em>, <em>client=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuprint/queries.html#fetch_custom_neurons"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neuprint.queries.fetch_custom_neurons" title="Permalink to this definition">¶</a></dt>
<dd><p>Use a custom query to fetch a neuron table, with nicer output
than you would get from a call to <a class="reference internal" href="#neuprint.queries.fetch_custom" title="neuprint.queries.fetch_custom"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_custom()</span></code></a>.</p>
<p>Returns data in the the same format as <a class="reference internal" href="#neuprint.queries.fetch_neurons" title="neuprint.queries.fetch_neurons"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_neurons()</span></code></a>.
but allows you to provide your own cypher query logic
(subject to certain requirements; see below).</p>
<p>This function includes all Neuron fields in the results,
and also sends back ROI counts as a separate table.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>q</strong> – Custom query. Must match a neuron named <code class="docutils literal notranslate"><span class="pre">n</span></code>,
and must <code class="docutils literal notranslate"><span class="pre">RETURN</span> <span class="pre">n</span></code>.</li>
<li><strong>neuprint_rois</strong> – Optional.  The list of ROI names from neuprint.
If not provided, they will be fetched
(so that ROI boolean columns can be dropped from the results).</li>
<li><strong>client</strong> – If not provided, the global default <code class="docutils literal notranslate"><span class="pre">Client</span></code> will be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>Two DataFrames.
<code class="docutils literal notranslate"><span class="pre">(neurons_df,</span> <span class="pre">roi_counts_df)</span></code></p>
<p>In <code class="docutils literal notranslate"><span class="pre">neurons_df</span></code>, all available columns <code class="docutils literal notranslate"><span class="pre">:Neuron</span></code> columns are returned, with the following changes:</p>
<blockquote>
<div><ul class="simple">
<li>ROI boolean columns are removed</li>
<li><code class="docutils literal notranslate"><span class="pre">roiInfo</span></code> is parsed as json data</li>
<li><code class="docutils literal notranslate"><span class="pre">somaLocation</span></code> is provided as a list <code class="docutils literal notranslate"><span class="pre">[x,</span> <span class="pre">y,</span> <span class="pre">z]</span></code></li>
<li>New columns <code class="docutils literal notranslate"><span class="pre">inputRoi</span></code> and <code class="docutils literal notranslate"><span class="pre">outputRoi</span></code> contain lists of each neuron’s ROIs.</li>
</ul>
</div></blockquote>
<p>In <code class="docutils literal notranslate"><span class="pre">roi_counts_df</span></code>, the <code class="docutils literal notranslate"><span class="pre">roiInfo</span></code> has been loadded into a table
of per-neuron-per-ROI synapse counts, with separate columns
for <code class="docutils literal notranslate"><span class="pre">pre</span></code> (outputs) and <code class="docutils literal notranslate"><span class="pre">post</span></code> (inputs).</p>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neuprint.queries.fetch_simple_connections">
<code class="descclassname">neuprint.queries.</code><code class="descname">fetch_simple_connections</code><span class="sig-paren">(</span><em>upstream_criteria=None, downstream_criteria=None, min_weight=1, properties=['type', 'instance'], *, client=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuprint/queries.html#fetch_simple_connections"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neuprint.queries.fetch_simple_connections" title="Permalink to this definition">¶</a></dt>
<dd><p>Find all connections from a set of “upstream” neurons,
or to a set of “downstream” neurons,
or all connections from a set of upstream neurons to a set of downstream neurons.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>upstream_criteria</strong> – SegmentCriteria indicating how to filter for neurons
on the presynaptic side of connections.</li>
<li><strong>downstream_criteria</strong> – SegmentCriteria indicating how to filter for neurons
on the postsynaptic side of connections.</li>
<li><strong>min_weight</strong> – Exclude connections below this weight.</li>
<li><strong>properties</strong> – Additional columns to include in the results, for both the upstream and downstream body.</li>
<li><strong>client</strong> – If not provided, the global default <a class="reference internal" href="client.html#neuprint.client.Client" title="neuprint.client.Client"><code class="xref py py-class docutils literal notranslate"><span class="pre">Client</span></code></a> will be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">DataFrame
One row per connection, with columns for upstream and downstream properties.</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This function is not intended to be used with very large neuron sets.
To fetch all adjacencies between a large set of neurons,
set <a class="reference internal" href="#neuprint.queries.fetch_adjacencies" title="neuprint.queries.fetch_adjacencies"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_adjacencies()</span></code></a>, which queries the server in batches.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="neuprint.queries.fetch_common_connectivity">
<code class="descclassname">neuprint.queries.</code><code class="descname">fetch_common_connectivity</code><span class="sig-paren">(</span><em>criteria, search_direction='upstream', min_weight=1, properties=['type', 'instance'], *, client=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuprint/queries.html#fetch_common_connectivity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neuprint.queries.fetch_common_connectivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a set of neurons that match the given criteria, find neurons
that connect to ALL of the neurons in the set, i.e. connections
that are common to all neurons in the matched set.</p>
<p>This is the Python equivalent to the Neuprint Explorer <a class="reference external" href="https://neuprint.janelia.org/?dataset=hemibrain%3Av1.0&amp;qt=commonconnectivity&amp;q=1">Common Connectivity</a> page.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>criteria</strong> – <a class="reference internal" href="segmentcriteria.html#neuprint.SegmentCriteria" title="neuprint.SegmentCriteria"><code class="xref py py-class docutils literal notranslate"><span class="pre">SegmentCriteria</span></code></a> used to determine the match set,
for which common connections will be found.</li>
<li><strong>search_direction</strong> (<code class="docutils literal notranslate"><span class="pre">&quot;upstream&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;downstream&quot;</span></code>) – Whether or not to search for common connections upstream of
the matched neurons or downstream of the matched neurons.</li>
<li><strong>min_weight</strong> – Connections below the given strength will not be included in the results.</li>
<li><strong>properties</strong> – Additional columns to include in the results, for both the upstream and downstream body.</li>
<li><strong>client</strong> – If not provided, the global default <a class="reference internal" href="client.html#neuprint.client.Client" title="neuprint.client.Client"><code class="xref py py-class docutils literal notranslate"><span class="pre">Client</span></code></a> will be used.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Returns: DataFrame</dt>
<dd>(Same format as returned by <a class="reference internal" href="#neuprint.queries.fetch_simple_connections" title="neuprint.queries.fetch_simple_connections"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_simple_connections()</span></code></a>.)
One row per connection, with columns for upstream and downstream properties.
For instance, if <code class="docutils literal notranslate"><span class="pre">search_direction=&quot;upstream&quot;</span></code>, then the matched neurons will appear
in the <code class="docutils literal notranslate"><span class="pre">downstream_</span></code> columns, and the common connections will appear in the <code class="docutils literal notranslate"><span class="pre">upstream_</span></code>
columns.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="neuprint.queries.fetch_shortest_paths">
<code class="descclassname">neuprint.queries.</code><code class="descname">fetch_shortest_paths</code><span class="sig-paren">(</span><em>upstream_bodyId</em>, <em>downstream_bodyId</em>, <em>min_weight=1</em>, <em>intermediate_criteria=None</em>, <em>timeout=5.0</em>, <em>*</em>, <em>client=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuprint/queries.html#fetch_shortest_paths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neuprint.queries.fetch_shortest_paths" title="Permalink to this definition">¶</a></dt>
<dd><p>Find all neurons along the shortest path between two neurons.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>upstream_bodyId</strong> – The starting neuron</li>
<li><strong>downstream_bodyId</strong> – The destination neuron</li>
<li><strong>min_weight</strong> – Minimum connection strength for each step in the path.</li>
<li><strong>intermediate_criteria</strong> (<a class="reference internal" href="segmentcriteria.html#neuprint.SegmentCriteria" title="neuprint.SegmentCriteria"><code class="xref py py-class docutils literal notranslate"><span class="pre">SegmentCriteria</span></code></a>) – Filtering criteria for neurons on path.
All intermediate neurons in the path must satisfy this criteria.
By default, <code class="docutils literal notranslate"><span class="pre">SegmentCriteria(status=&quot;Traced&quot;)</span></code> is used.</li>
<li><strong>timeout</strong> – Give up after this many seconds, in which case an <strong>empty DataFrame is returned.</strong>
No exception is raised!</li>
<li><strong>client</strong> – If not provided, the global default <a class="reference internal" href="client.html#neuprint.client.Client" title="neuprint.client.Client"><code class="xref py py-class docutils literal notranslate"><span class="pre">Client</span></code></a> will be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>All paths are concatenated into a single DataFrame.
The <cite>path</cite> column indicates which path that row belongs to.
The <cite>weight</cite> column indicates the connection strength to that
body from the previous body in the path.</p>
<p class="rubric">Example</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">fetch_shortest_paths</span><span class="p">(</span><span class="mi">329566174</span><span class="p">,</span> <span class="mi">294792184</span><span class="p">,</span> <span class="n">min_weight</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gh">Out[1]:</span>
<span class="go">      path     bodyId                       type  weight</span>
<span class="go">0        0  329566174                    OA-VPM3       0</span>
<span class="go">1        0  517169460                 PDL05h_pct      11</span>
<span class="go">2        0  297251714                ADM01om_pct      15</span>
<span class="go">3        0  294424196                PDL13ob_pct      11</span>
<span class="go">4        0  295133927               PDM18a_d_pct      10</span>
<span class="go">...    ...        ...                        ...     ...</span>
<span class="go">5773   962  511271574                 ADL24h_pct      43</span>
<span class="go">5774   962  480923210                PDL10od_pct      18</span>
<span class="go">5775   962  294424196                PDL13ob_pct      21</span>
<span class="go">5776   962  295133927               PDM18a_d_pct      10</span>
<span class="go">5777   962  294792184  olfactory multi vPN mlALT      10</span>

<span class="go">[5778 rows x 4 columns]</span>
</pre></div>
</div>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neuprint.queries.fetch_adjacencies">
<code class="descclassname">neuprint.queries.</code><code class="descname">fetch_adjacencies</code><span class="sig-paren">(</span><em>criteria</em>, <em>export_dir=None</em>, <em>batch_size=200</em>, <em>*</em>, <em>client=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuprint/queries.html#fetch_adjacencies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neuprint.queries.fetch_adjacencies" title="Permalink to this definition">¶</a></dt>
<dd><p>Fetch the adjacency table for connections amongst a set of neurons, broken down by ROI.
Only primary ROIs are included in the per-ROI connection table.
Connections outside of the primary ROIs are labeled with the special name
<cite>NotPrimary</cite> (which is not currently an ROI name in neuprint itself).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>criteria</strong> – Limit results to connections between bodies that match this criteria.</li>
<li><strong>export_dir</strong> – Optional. Export CSV files for the neuron table,
connection table (total weight), and connection table (per ROI).</li>
<li><strong>batch_size</strong> – For optimal performance, connections will be fetched in batches.
This parameter specifies the batch size.</li>
<li><strong>label</strong> – Either ‘Neuron’ or ‘Segment’ (which includes Neurons)</li>
<li><strong>client</strong> – If not provided, the global default <a class="reference internal" href="client.html#neuprint.client.Client" title="neuprint.client.Client"><code class="xref py py-class docutils literal notranslate"><span class="pre">Client</span></code></a> will be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Two DataFrames, <code class="docutils literal notranslate"><span class="pre">(traced_neurons_df,</span> <span class="pre">roi_conn_df,</span> <span class="pre">total_conn_df)</span></code>,
containing the table of neuron IDs and the per-ROI connection table,
respectively. See caveat above concerning non-primary ROIs.</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_traced_adjacecies()</span></code></p>
</div>
</dd></dl>

<dl class="function">
<dt id="neuprint.queries.fetch_traced_adjacencies">
<code class="descclassname">neuprint.queries.</code><code class="descname">fetch_traced_adjacencies</code><span class="sig-paren">(</span><em>export_dir=None</em>, <em>batch_size=200</em>, <em>*</em>, <em>client=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuprint/queries.html#fetch_traced_adjacencies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neuprint.queries.fetch_traced_adjacencies" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function for calling <a class="reference internal" href="#neuprint.queries.fetch_adjacencies" title="neuprint.queries.fetch_adjacencies"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_adjacencies()</span></code></a>
for traced, non-cropped neurons.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">On the hemibrain dataset, this function takes a few minutes to run,
and the results are somewhat large (~300 MB).</p>
</div>
<p class="rubric">Example</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">neurons_df</span><span class="p">,</span> <span class="n">roi_conn_df</span> <span class="o">=</span> <span class="n">fetch_traced_adjacencies</span><span class="p">(</span><span class="s1">&#39;exported-connections&#39;</span><span class="p">)</span>

<span class="gp">In [2]: </span><span class="n">roi_conn_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="gh">Out[2]:</span>
<span class="go">       bodyId_pre  bodyId_post        roi  weight</span>
<span class="go">0      5813009352    516098538     SNP(R)       2</span>
<span class="go">1      5813009352    516098538     SLP(R)       2</span>
<span class="go">2       326119769    516098538     SNP(R)       1</span>
<span class="go">3       326119769    516098538     SLP(R)       1</span>
<span class="go">4       915960391    202916528         FB       1</span>

<span class="gp">In [3]: </span><span class="c1"># Obtain total weights (instead of per-connection-per-ROI weights)</span>
<span class="gp">   ...: </span><span class="n">conn_groups</span> <span class="o">=</span> <span class="n">roi_conn_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;bodyId_pre&#39;</span><span class="p">,</span> <span class="s1">&#39;bodyId_post&#39;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">   ...: </span><span class="n">total_conn_df</span> <span class="o">=</span> <span class="n">conn_groups</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">   ...: </span><span class="n">total_conn_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="gh">Out[3]:</span>
<span class="go">   bodyId_pre  bodyId_post  weight</span>
<span class="go">0   202916528    203253253       2</span>
<span class="go">1   202916528    203257652       2</span>
<span class="go">2   202916528    203598557       2</span>
<span class="go">3   202916528    234292899       4</span>
<span class="go">4   202916528    264986706       2</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="neuprint.queries.fetch_meta">
<code class="descclassname">neuprint.queries.</code><code class="descname">fetch_meta</code><span class="sig-paren">(</span><em>*</em>, <em>client=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuprint/queries.html#fetch_meta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neuprint.queries.fetch_meta" title="Permalink to this definition">¶</a></dt>
<dd><p>Fetch the dataset metadata, parsing json fields where necessary.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
<p>Example</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">meta</span> <span class="o">=</span> <span class="n">fetch_meta</span><span class="p">()</span>

<span class="gp">In [2]: </span><span class="nb">list</span><span class="p">(</span><span class="n">meta</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="gh">Out[2]:</span>
<span class="go">[&#39;dataset&#39;,</span>
<span class="go"> &#39;info&#39;,</span>
<span class="go"> &#39;lastDatabaseEdit&#39;,</span>
<span class="go"> &#39;latestMutationId&#39;,</span>
<span class="go"> &#39;logo&#39;,</span>
<span class="go"> &#39;meshHost&#39;,</span>
<span class="go"> &#39;neuroglancerInfo&#39;,</span>
<span class="go"> &#39;neuroglancerMeta&#39;,</span>
<span class="go"> &#39;postHPThreshold&#39;,</span>
<span class="go"> &#39;postHighAccuracyThreshold&#39;,</span>
<span class="go"> &#39;preHPThreshold&#39;,</span>
<span class="go"> &#39;primaryRois&#39;,</span>
<span class="go"> &#39;roiHierarchy&#39;,</span>
<span class="go"> &#39;roiInfo&#39;,</span>
<span class="go"> &#39;statusDefinitions&#39;,</span>
<span class="go"> &#39;superLevelRois&#39;,</span>
<span class="go"> &#39;tag&#39;,</span>
<span class="go"> &#39;totalPostCount&#39;,</span>
<span class="go"> &#39;totalPreCount&#39;,</span>
<span class="go"> &#39;uuid&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="neuprint.queries.fetch_all_rois">
<code class="descclassname">neuprint.queries.</code><code class="descname">fetch_all_rois</code><span class="sig-paren">(</span><em>*</em>, <em>client=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuprint/queries.html#fetch_all_rois"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neuprint.queries.fetch_all_rois" title="Permalink to this definition">¶</a></dt>
<dd><p>Fetch the list of all ROIs in the dataset,
from the dataset metadata.</p>
</dd></dl>

<dl class="function">
<dt id="neuprint.queries.fetch_primary_rois">
<code class="descclassname">neuprint.queries.</code><code class="descname">fetch_primary_rois</code><span class="sig-paren">(</span><em>*</em>, <em>client=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuprint/queries.html#fetch_primary_rois"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neuprint.queries.fetch_primary_rois" title="Permalink to this definition">¶</a></dt>
<dd><p>Fetch the list of ‘primary’ ROIs in the dataset,
from the dataset metadata.
Primary ROIs do not overlap with each other.</p>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="segmentcriteria.html" class="btn btn-neutral float-right" title="SegmentCriteria" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="client.html" class="btn btn-neutral float-left" title="Client" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, FlyEM

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>